# -*- coding: utf-8 -*-
"""Rent_prediction_model.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1CkDmiJ-IN7PJqGeB2h0VxZ1kTJocyMdP
"""

import pandas as pd

df = pd.read_csv("/content/PG_listings.csv")
print("Column names:", list(df.columns))

# Strip and lowercase
df.columns = df.columns.str.strip().str.lower()
print("Cleaned column names:", list(df.columns))

df.rename(columns={'desc': 'description'}, inplace=True)

import pandas as pd

df = pd.read_csv("/content/PG_listings.csv")
df.columns = df.columns.str.strip().str.lower()
print("Columns:", list(df.columns))

# Rename if needed
if 'desc' in df.columns:
    df.rename(columns={'desc': 'description'}, inplace=True)

X = df['descriptions']
y = df['rent']

import pandas as pd
from sklearn.model_selection import train_test_split

# Load and clean data
df = pd.read_csv("/content/PG_listings.csv")
df.columns = df.columns.str.strip().str.lower()

# Use correct column name
X = df['descriptions']
y = df['rent']

# Train/test split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

from sklearn.pipeline import Pipeline
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LinearRegression
import pickle
import os

# Step 1: Create a pipeline: TF-IDF + Regressor
model_pipeline = Pipeline([
    ('tfidf', TfidfVectorizer()),
    ('regressor', LinearRegression())
])

# Step 2: Fit the model
model_pipeline.fit(X_train, y_train)

# Step 3: Save the trained model
os.makedirs("models", exist_ok=True)
with open("models/rent_prediction_model.pkl", "wb") as f:
    pickle.dump(model_pipeline, f)

print(" Model trained and saved as models/rent_prediction_model.pkl")

# Load model and test a prediction
with open("models/rent_prediction_model.pkl", "rb") as f:
    model = pickle.load(f)

desc = "Spacious PG with AC, WiFi and food near metro station"
predicted_rent = model.predict([desc])[0]
print("Predicted Rent: ₹", round(predicted_rent))

import pickle

# Load the trained model
with open("models/rent_prediction_model.pkl", "rb") as f:
    model = pickle.load(f)

# New PG descriptions to predict
new_descriptions = [
    "Fully furnished PG with AC, meals, and laundry service near Electronic City",
    "Single room in 2BHK flat, shared bathroom, no food, 1.5 km from metro station",
    "Luxury co-living PG with WiFi, gym, housekeeping near Indiranagar"
]

# Predict rent
predicted_rents = model.predict(new_descriptions)

# Display results
for desc, rent in zip(new_descriptions, predicted_rents):
    print(f"Description: {desc}")
    print(f"Predicted Rent: ₹ {round(rent)}\n")